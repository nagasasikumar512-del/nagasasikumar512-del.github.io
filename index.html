<!DOCTYPE html>
<html>
<head>
<title>EasyReward</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
margin:0;
font-family:Arial, sans-serif;
background:linear-gradient(135deg,#1e3c72,#2a5298);
display:flex;
justify-content:center;
align-items:center;
height:100vh;
}

.box{
background:#fff;
padding:30px;
border-radius:18px;
width:90%;
max-width:420px;
text-align:center;
box-shadow:0 15px 30px rgba(0,0,0,0.25);
animation:fade 0.4s ease;
}

@keyframes fade{
from{opacity:0;transform:translateY(10px);}
to{opacity:1;transform:translateY(0);}
}

input,button{
width:100%;
padding:14px;
margin:8px 0;
border-radius:10px;
border:1px solid #ddd;
font-size:16px;
}

button{
background:#2a5298;
color:white;
border:none;
cursor:pointer;
font-weight:bold;
}

button:hover{
opacity:0.9;
}

.google{
background:#f5f5f5;
color:black;
border:1px solid #ccc;
}

.small{
font-size:13px;
color:gray;
}
</style>
</head>

<body>

<div id="loginBox" class="box">
<h2>EasyReward ðŸ’°</h2>

<input id="email" type="email" placeholder="Email" required>
<input id="password" type="password" placeholder="Password" required>

<button onclick="signup()">Sign Up</button>
<button onclick="login()">Login</button>
<button class="google" onclick="googleLogin()">Continue with Google</button>

<p class="small">Verify email after signup</p>
</div>

<div id="dashboard" class="box" style="display:none;">
<h2>Dashboard</h2>
<h1 id="points">0</h1>
<button onclick="earn()">Earn +10</button>
<button onclick="logout()">Logout</button>
</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";

import {
getAuth,
createUserWithEmailAndPassword,
signInWithEmailAndPassword,
GoogleAuthProvider,
signInWithPopup,
sendEmailVerification,
signOut,
onAuthStateChanged
} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";

import {
getFirestore,
doc,
setDoc,
getDoc,
updateDoc,
increment
} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

/* ðŸ”¥ YOUR FIREBASE CONFIG */
const firebaseConfig={
apiKey:"AIzaSyAQjcbcugInknWIbblR6a2G7Nzfyml7B0g",
authDomain:"easyreward-764ed.firebaseapp.com",
projectId:"easyreward-764ed"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getFirestore(app);
const provider=new GoogleAuthProvider();

let userId=null;

/* SIGN UP */
window.signup=async()=>{
try{
const userCred=await createUserWithEmailAndPassword(
auth,
email.value,
password.value
);

await sendEmailVerification(userCred.user);

await setDoc(doc(db,"users",userCred.user.uid),{
points:0,
createdAt:new Date()
});

alert("Signup successful! Verify your email.");
}catch(error){
alert(error.message);
}
};

/* LOGIN */
window.login=async()=>{
try{
const userCred=await signInWithEmailAndPassword(
auth,
email.value,
password.value
);

if(!userCred.user.emailVerified){
alert("Please verify your email first.");
await signOut(auth);
return;
}

}catch(error){
alert(error.message);
}
};

/* GOOGLE LOGIN */
window.googleLogin=async()=>{
try{
const result=await signInWithPopup(auth,provider);
const ref=doc(db,"users",result.user.uid);
const snap=await getDoc(ref);

if(!snap.exists()){
await setDoc(ref,{
points:0,
createdAt:new Date()
});
}
}catch(error){
alert(error.message);
}
};

/* LOGOUT */
window.logout=()=>signOut(auth);

/* EARN POINTS */
window.earn=async()=>{
const ref=doc(db,"users",userId);
await updateDoc(ref,{points:increment(10)});
loadPoints();
};

/* LOAD POINTS */
async function loadPoints(){
const snap=await getDoc(doc(db,"users",userId));
document.getElementById("points").innerText=snap.data().points;
}

/* AUTH STATE */
onAuthStateChanged(auth,async(user)=>{
if(user){
userId=user.uid;
loginBox.style.display="none";
dashboard.style.display="block";
loadPoints();
}else{
loginBox.style.display="block";
dashboard.style.display="none";
}
});

</script>

</body>
</html>

