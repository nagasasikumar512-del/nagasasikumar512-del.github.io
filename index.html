<!DOCTYPE html>
<html>
<head>
  <title>EasyReward</title>
  <style>
    body {
      margin: 0;
      font-family: Arial;
      background: linear-gradient(135deg, #1e3c72, #2a5298);
      color: white;
      text-align: center;
      padding: 20px;
    }

    .box {
      background: white;
      color: black;
      padding: 30px;
      border-radius: 12px;
      max-width: 350px;
      margin: auto;
      margin-top: 100px;
    }

    input, button {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
    }
  </style>
</head>

<body>

<div id="login" class="box">
  <h2>EasyReward ðŸ’°</h2>
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <button onclick="signup()">Sign Up</button>
  <button onclick="login()">Login</button>
</div>

<div id="dashboard" class="box" style="display:none;">
  <h2>Your Dashboard</h2>
  <h1 id="points">0</h1>
  <button onclick="earn()">Earn +10</button>
  <button onclick="logout()">Logout</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged }
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";

import { getFirestore, doc, setDoc, getDoc, updateDoc, increment }
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAQjcbcugInknWIbblR6a2G7Nzfyml7B0g",
  authDomain: "easyreward-764ed.firebaseapp.com",
  projectId: "easyreward-764ed"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let userId = null;

window.signup = async function() {
  const email = email.value;
  const password = password.value;
  const user = await createUserWithEmailAndPassword(auth, email, password);
  await setDoc(doc(db, "users", user.user.uid), { points: 0 });
}

window.login = async function() {
  await signInWithEmailAndPassword(auth, email.value, password.value);
}

window.logout = function() {
  signOut(auth);
}

window.earn = async function() {
  const ref = doc(db, "users", userId);
  await updateDoc(ref, { points: increment(10) });
  loadPoints();
}

async function loadPoints() {
  const snap = await getDoc(doc(db, "users", userId));
  document.getElementById("points").innerText = snap.data().points;
}

onAuthStateChanged(auth, async user => {
  if (user) {
    userId = user.uid;
    login.style.display = "none";
    dashboard.style.display = "block";
    loadPoints();
  } else {
    login.style.display = "block";
    dashboard.style.display = "none";
  }
});
</script>

</body>
</html>
