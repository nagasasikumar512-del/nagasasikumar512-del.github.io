<!DOCTYPE html>
<html>
<head>
<title>EasyReward</title>

<style>
body {
  margin:0;
  font-family:Arial;
  background:linear-gradient(135deg,#1e3c72,#2a5298);
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

.box {
  background:white;
  padding:35px;
  border-radius:16px;
  width:360px;
  box-shadow:0 10px 25px rgba(0,0,0,0.25);
  text-align:center;
}

h2 { margin-bottom:20px; }

input {
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:8px;
  border:1px solid #ccc;
}

button {
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:8px;
  border:none;
  cursor:pointer;
  font-size:16px;
}

.primary {
  background:#2a5298;
  color:white;
}

.google {
  background:white;
  border:1px solid #ddd;
}

.dashboard h1 {
  font-size:48px;
  margin:10px 0;
}
</style>

</head>

<body>

<div id="login" class="box">

<h2>EasyReward ðŸ’°</h2>

<input id="email" placeholder="Email">
<input id="password" type="password" placeholder="Password">

<button class="primary" onclick="signup()">Sign Up</button>
<button class="primary" onclick="login()">Login</button>

<button class="google" onclick="googleLogin()">
ðŸ”µ Continue with Google
</button>

</div>

<div id="dashboard" class="box dashboard" style="display:none;">

<h2>Your Dashboard</h2>
<h1 id="points">0</h1>

<button class="primary" onclick="earn()">Earn +10</button>
<button onclick="logout()">Logout</button>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";

import {
  getAuth,
  GoogleAuthProvider,
  signInWithPopup,
  createUserWithEmailAndPassword,
  signInWithEmailAndPassword,
  signOut,
  onAuthStateChanged
} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";

import {
  getFirestore,
  doc,
  setDoc,
  getDoc,
  updateDoc,
  increment
} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "easyreward-764ed.firebaseapp.com",
  projectId: "easyreward-764ed"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let userId = null;

window.signup = async () => {
  const user = await createUserWithEmailAndPassword(auth,email.value,password.value);
  await setDoc(doc(db,"users",user.user.uid),{points:0});
};

window.login = async () => {
  await signInWithEmailAndPassword(auth,email.value,password.value);
};

window.googleLogin = async () => {
  const provider = new GoogleAuthProvider();
  const result = await signInWithPopup(auth,provider);

  const ref = doc(db,"users",result.user.uid);
  const snap = await getDoc(ref);

  if(!snap.exists()){
    await setDoc(ref,{points:0});
  }
};

window.logout = () => signOut(auth);

window.earn = async () => {
  const ref = doc(db,"users",userId);
  await updateDoc(ref,{points:increment(10)});
  loadPoints();
};

async function loadPoints(){
  const snap = await getDoc(doc(db,"users",userId));
  document.getElementById("points").innerText = snap.data().points;
}

onAuthStateChanged(auth,async user=>{
  if(user){
    userId=user.uid;
    login.style.display="none";
    dashboard.style.display="block";
    loadPoints();
  } else {
    login.style.display="block";
    dashboard.style.display="none";
  }
});

</script>

</body>
</html>

